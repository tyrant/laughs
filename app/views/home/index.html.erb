<% content_for :map_script do %>
  <script src="https://maps.googleapis.com/maps/api/js?key=<%= GP::API_KEY %>"></script>
<% end %>
<script>
$(document).ready(function() {
  app.map();
});
</script>

<div id="laughs">
  <div id="banner">
    <span id="blurb">
      Find your favourite comics' gigs.
    </span>
    <a id="toggle_overlay" class="btn btn-default">
      <span class="glyphicon glyphicon-list" aria-hidden="true"></span>
    </a>
  </div>

  <div id="everything_else">

    <div id="map"></div>

    <div id="overlay" class="container">

      <ul class="nav nav-tabs" role="tablist">
      
        <li role="presentation" class="active">
          <a href="#form" aria-controls="form" role="tab" data-toggle="tab">Search</a>
        </li>
        <li role="presentation">
          <a href="#faq" aria-controls="embed" role="tab" data-toggle="tab">FAQs</a>
        </li>
      </ul>

      <div class="tab-content">

        <div role="tabpanel" class="tab-pane active" id="form">
          <form id="filter" method="get" data-remote="true" action="/venues">

            <div class="form-group">
              <select name="comedians[]" id="comedians" class="form-control" multiple="multiple" style="width: 100%;">
                <% Comedian.ordered_by_surname.each do |comedian| %>
                  <option value="<%= comedian.id %>"
                    <% if params.has_key?(:comedians) and params[:comedians].include?(comedian.id.to_s) %>
                      selected="selected"
                    <% end %>
                    data-src="<%= comedian.mugshot.url(:thumb) %>"
                    >
                    <%= comedian.name %>
                  </option>
                <% end %>
              </select>
            </div>

            <div class="row">
              <div class="col-xs-6 start-container">
                <div class="form-group">
                  <div class="input-group date" id="start_date">
                    <span class="input-group-addon">
                      <span class="glyphicon glyphicon-calendar"></span>
                      From
                    </span>
                    <input type="text" name="start_date" class="form-control" />
                  </div>
                </div>
              </div>

              <div class="col-xs-6 end-container">
                <div class="form-group">
                  <div class="input-group date" id="end_date">
                    <span class="input-group-addon">
                      <span class="glyphicon glyphicon-calendar"></span>
                      Until
                    </span>
                    <input type="text" name="end_date" class="form-control" />
                  </div>
                </div>
              </div>
            </div>
            
          </form>
        </div>

        <div role="tabpanel" class="tab-pane" id="faq">

          <div class="panel-group" id="faq_accordion" role="tablist" aria-multiselectable="true">
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingOne">
                <h4 class="panel-title">
                  <a role="button" data-toggle="collapse" data-parent="#faq_accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    My favourite comedian isn't on here! What gives?
                  </a>
                </h4>
              </div>
              <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="panel-body">
                  <p>
                    And here's me claiming your favourite comic is already here! My bad :( Thing is, I have to write a separate script to get the data for each comic, and that shit takes time. I'm adding them as fast as I can. If you'd like me to bump your comic up the list, flick me an email at epicschnozz[at]gmail[dot]com.
                  </p>
                  <p>
                    That said, sometimes I've tried to add comedians and couldn't. Sarah Millican, Ricky Gervais, others, they're just not touring right now. <a href="http://www.sarahmillican.co.uk/live-tour">See?</a>
                  </p>
                  <p>
                    Then again, I did write these words way back in January 2017. In whatever Star Trek future you're reading this in, maybe she's started touring again. 
                  </p>
                </div>
              </div>
            </div>

            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingTwo">
                <h4 class="panel-title">
                  <a role="button" data-toggle="collapse" data-parent="#faq_accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    This comedy-search app thingy seems kinda cool. Can I install it on my own website?
                  </a>
                </h4>
              </div>
              <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                <div class="panel-body">
                  <p>
                    Please do! Here's how:
                  </p>
                  <p>
                    First, adjust the map and form to display the gigs you'd like. You'll notice that with each tweak, the URL changes to match. Copy it.
                  </p>
                  <p>
                    Second, add this code to your site:
                  </p>
                  <p>
                    <code>
                      &lt;iframe<br>
                        width="<em>Your pixel width here</em>"<br>
                        height="<em>Your pixel height here</em>"<br>
                        src="<em>Your copied-and-pasted URL here</em>"&gt;<br>
                      &lt;/iframe&gt;
                    </code>
                  </p>
                  <p>
                    And that's it! The embedded widget will behave exactly as a normal web page.
                  </p>
                </div>
              </div>
            </div>

          </div>
        </div>

      </div>

    </div>

  </div>

</div>